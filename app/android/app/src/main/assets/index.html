<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Multiplayer + Analysis</title>
    <link rel="stylesheet" href="chessboard.min.css">
    <link rel="stylesheet" href="multiplayer.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 data-i18n="title">‚ôüÔ∏è Chess Multiplayer</h1>
            <div class="header-controls">
                <div class="language-selector">
                    <button class="lang-btn active" data-lang="ru" title="–†—É—Å—Å–∫–∏–π">RU</button>
                    <button class="lang-btn" data-lang="en" title="English">EN</button>
                    <button class="lang-btn" data-lang="uk" title="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞">UA</button>
                </div>
                <div class="theme-selector">
                    <button class="theme-btn" data-theme="dark" data-i18n-title="darkTheme">üåô</button>
                    <button class="theme-btn active" data-theme="lichess" data-i18n-title="lichessTheme">‚ôüÔ∏è</button>
                    <button class="theme-btn" data-theme="light" data-i18n-title="lightTheme">‚òÄÔ∏è</button>
                </div>
                <button id="loginBtn" class="btn btn-login" data-i18n="login">üë§ –í–æ–π—Ç–∏</button>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
        <div id="loginModal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 data-i18n="loginRegister">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login" data-i18n="loginTab">–í—Ö–æ–¥</button>
                    <button class="auth-tab" data-tab="register" data-i18n="registerTab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <div id="loginTab" class="auth-form">
                    <input type="text" id="loginUsername" data-i18n="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" />
                    <input type="password" id="loginPassword" data-i18n="password" placeholder="–ü–∞—Ä–æ–ª—å" />
                    <button id="loginSubmit" class="btn btn-primary" data-i18n="loginBtn">–í–æ–π—Ç–∏</button>
                </div>
                <div id="registerTab" class="auth-form hidden">
                    <input type="text" id="registerUsername" data-i18n="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" />
                    <input type="password" id="registerPassword" data-i18n="password" placeholder="–ü–∞—Ä–æ–ª—å" />
                    <input type="password" id="registerPasswordConfirm" data-i18n="confirmPassword" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" />
                    <button id="registerSubmit" class="btn btn-primary" data-i18n="registerBtn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </div>
                <div id="userProfile" class="user-profile hidden">
                    <div class="profile-info">
                        <h3 id="profileUsername"></h3>
                        <p><span data-i18n="gamesPlayed">–ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ</span>: <span id="profileGames">0</span></p>
                        <p><span data-i18n="wins">–ü–æ–±–µ–¥</span>: <span id="profileWins">0</span></p>
                        <p><span data-i18n="rating">–†–µ–π—Ç–∏–Ω–≥</span>: <span id="profileRating">1200</span></p>
                    </div>
                    <button id="logoutBtn" class="btn btn-danger" data-i18n="logout">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞ -->
        <div id="botDifficultyModal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 data-i18n="selectDifficulty">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</h2>
                <div class="difficulty-buttons">
                    <button class="btn btn-difficulty btn-easy" data-difficulty="easy">
                        <span data-i18n="easy">–õ–µ–≥–∫–æ</span>
                        <small>~800-1000</small>
                    </button>
                    <button class="btn btn-difficulty btn-medium" data-difficulty="medium">
                        <span data-i18n="medium">–°—Ä–µ–¥–Ω–µ</span>
                        <small>~1200-1400</small>
                    </button>
                    <button class="btn btn-difficulty btn-hard" data-difficulty="hard">
                        <span data-i18n="hard">–°–ª–æ–∂–Ω–æ</span>
                        <small>~1600-1800</small>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –¥–æ—Å–∫–∏ -->
        <div id="boardEditorModal" class="modal hidden">
            <div class="modal-content modal-large">
                <span class="close">&times;</span>
                <h2 data-i18n="boardEditor">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –¥–æ—Å–∫–∏</h2>
                
                <div class="editor-controls">
                    <div class="editor-pieces">
                        <h4 data-i18n="addPieces">–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–≥—É—Ä—ã:</h4>
                        <div class="piece-selector">
                            <button class="piece-btn" data-piece="wK">‚ôî</button>
                            <button class="piece-btn" data-piece="wQ">‚ôï</button>
                            <button class="piece-btn" data-piece="wR">‚ôñ</button>
                            <button class="piece-btn" data-piece="wB">‚ôó</button>
                            <button class="piece-btn" data-piece="wN">‚ôò</button>
                            <button class="piece-btn" data-piece="wP">‚ôô</button>
                        </div>
                        <div class="piece-selector">
                            <button class="piece-btn" data-piece="bK">‚ôö</button>
                            <button class="piece-btn" data-piece="bQ">‚ôõ</button>
                            <button class="piece-btn" data-piece="bR">‚ôú</button>
                            <button class="piece-btn" data-piece="bB">‚ôù</button>
                            <button class="piece-btn" data-piece="bN">‚ôû</button>
                            <button class="piece-btn" data-piece="bP">‚ôü</button>
                        </div>
                        <button class="piece-btn piece-btn-remove" data-piece="remove">üóëÔ∏è</button>
                    </div>
                    
                    <div class="editor-actions">
                        <button id="editorClearBtn" class="btn" data-i18n="clearBoard">–û—á–∏—Å—Ç–∏—Ç—å –¥–æ—Å–∫—É</button>
                        <button id="editorStartBtn" class="btn" data-i18n="startPosition">–ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è</button>
                        <div class="turn-selector">
                            <button id="editorWhiteTurn" class="btn btn-turn active" data-i18n="whiteToMove">–•–æ–¥ –±–µ–ª—ã—Ö</button>
                            <button id="editorBlackTurn" class="btn btn-turn" data-i18n="blackToMove">–•–æ–¥ —á–µ—Ä–Ω—ã—Ö</button>
                        </div>
                    </div>
                    
                    <div class="editor-play">
                        <h4 data-i18n="playFromPosition">–ò–≥—Ä–∞—Ç—å —Å –ø–æ–∑–∏—Ü–∏–∏:</h4>
                        <button id="editorPlayFriend" class="btn btn-primary" data-i18n="playWithFriend">–° –¥—Ä—É–≥–æ–º</button>
                        <button id="editorPlayBot" class="btn btn-bot" data-i18n="playWithBot">–° –±–æ—Ç–æ–º</button>
                        <button id="editorPlaySolo" class="btn btn-success" data-i18n="playSolo">–°–∞–º —Å —Å–æ–±–æ–π</button>
                    </div>
                </div>
            </div>
        </div>
        
        <p class="subtitle" data-i18n="subtitle">–ò–≥—Ä–∞–π –æ–Ω–ª–∞–π–Ω + –∞–Ω–∞–ª–∏–∑ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        
        <div class="main-layout">
            <!-- –î–æ—Å–∫–∞ -->
            <div class="board-section">
                <div class="board-controls">
                    <button id="fullscreenBtn" class="icon-btn" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">‚õ∂</button>
                    <button id="flipBoardBtn" class="icon-btn" title="–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –¥–æ—Å–∫—É">üîÑ</button>
                    <button id="settingsBtn" class="icon-btn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="settingsPanel" class="settings-panel hidden">
                    <h4 data-i18n="pieceStyle">–°—Ç–∏–ª—å —Ñ–∏–≥—É—Ä</h4>
                    <div class="piece-style-selector">
                        <button class="piece-style-btn active" data-style="wikipedia" data-i18n="classic">–ö–ª–∞—Å—Å–∏–∫–∞</button>
                        <button class="piece-style-btn" data-style="alpha" data-i18n="alpha">–ê–ª—å—Ñ–∞</button>
                        <button class="piece-style-btn" data-style="uscf" data-i18n="uscf">USCF</button>
                    </div>
                    
                    <h4 data-i18n="boardColor">–¶–≤–µ—Ç –¥–æ—Å–∫–∏</h4>
                    <div class="board-color-selector">
                        <button class="board-color-btn active" data-color="brown" style="background: linear-gradient(135deg, #f0d9b5 50%, #b58863 50%)"></button>
                        <button class="board-color-btn" data-color="blue" style="background: linear-gradient(135deg, #dee3e6 50%, #8ca2ad 50%)"></button>
                        <button class="board-color-btn" data-color="green" style="background: linear-gradient(135deg, #ffffdd 50%, #86a666 50%)"></button>
                        <button class="board-color-btn" data-color="purple" style="background: linear-gradient(135deg, #e8e9b7 50%, #9f90b0 50%)"></button>
                        <button class="board-color-btn" data-color="wood" style="background: linear-gradient(135deg, #d4a574 50%, #8b5a3c 50%)"></button>
                    </div>
                </div>
                
                <div id="board" class="chessboard"></div>
                
                <div class="time-control">
                    <h3 data-i18n="timeControl">‚è±Ô∏è –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä–µ–º–µ–Ω–∏</h3>
                    <div class="time-buttons">
                        <button class="time-btn" data-time="60" data-i18n="bullet">‚ö° Bullet (1 –º–∏–Ω)</button>
                        <button class="time-btn" data-time="180" data-i18n="blitz">üèÉ Blitz (3 –º–∏–Ω)</button>
                        <button class="time-btn active" data-time="600" data-i18n="rapid">üéØ Rapid (10 –º–∏–Ω)</button>
                        <button class="time-btn" data-time="1800" data-i18n="classical">üê¢ Classical (30 –º–∏–Ω)</button>
                        <button class="time-btn" data-time="0" data-i18n="unlimited">‚ôæÔ∏è –ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏</button>
                    </div>
                </div>

                <div class="controls">
                    <button id="createGameBtn" class="btn btn-primary" data-i18n="createGame">üéÆ –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</button>
                    <button id="joinGameBtn" class="btn btn-success" data-i18n="joinGame">üîó –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                    <button id="playBotBtn" class="btn btn-bot" data-i18n="playBot">ü§ñ –ò–≥—Ä–∞—Ç—å —Å –±–æ—Ç–æ–º</button>
                    <button id="boardEditorBtn" class="btn btn-editor" data-i18n="boardEditor">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –¥–æ—Å–∫–∏</button>
                    
                    <!-- –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –∑–∞–¥–∞—á -->
                    <div class="puzzle-dropdown">
                        <button id="puzzleBtn" class="btn btn-puzzle" data-i18n="puzzles">üß© –ó–∞–¥–∞—á–∏ ‚ñº</button>
                        <div id="puzzleMenu" class="puzzle-menu hidden">
                            <button class="puzzle-category" data-category="mate1" data-i18n="mate1">‚ö° –ú–∞—Ç –≤ 1 —Ö–æ–¥</button>
                            <button class="puzzle-category" data-category="mate2" data-i18n="mate2">üéØ –ú–∞—Ç –≤ 2 —Ö–æ–¥–∞</button>
                            <button class="puzzle-category" data-category="mate3" data-i18n="mate3">üî• –ú–∞—Ç –≤ 3 —Ö–æ–¥–∞</button>
                            <button class="puzzle-category" data-category="tactics" data-i18n="tactics">‚≠ê –¢–∞–∫—Ç–∏–∫–∞</button>
                            <button class="puzzle-category" data-category="endgame" data-i18n="endgame">üëë –≠–Ω–¥—à–ø–∏–ª—å</button>
                            <button class="puzzle-category" data-category="famous" data-i18n="famous">üèÜ –ó–Ω–∞–º–µ–Ω–∏—Ç—ã–µ –ø–∞—Ä—Ç–∏–∏</button>
                        </div>
                    </div>
                    
                    <!-- –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –ø—Ä–∞–∫—Ç–∏–∫–∏ –º–∞—Ç–æ–≤ -->
                    <div class="puzzle-dropdown">
                        <button id="matePracticeBtn" class="btn btn-practice" data-i18n="matePractice">üëë –ü—Ä–∞–∫—Ç–∏–∫–∞ –º–∞—Ç–æ–≤ ‚ñº</button>
                        <div id="matePracticeMenu" class="puzzle-menu hidden">
                            <button class="mate-practice-category" data-mate="queenKing" data-i18n="queenKingMate">‚ôï –§–µ—Ä–∑—å –∏ –∫–æ—Ä–æ–ª—å</button>
                            <button class="mate-practice-category" data-mate="twoRooks" data-i18n="twoRooksMate">‚ôú‚ôú –î–≤–µ –ª–∞–¥—å–∏</button>
                            <button class="mate-practice-category" data-mate="rookKing" data-i18n="rookKingMate">‚ôú –õ–∞–¥—å—è –∏ –∫–æ—Ä–æ–ª—å</button>
                        </div>
                    </div>
                    
                    <button id="hintBtn" class="btn btn-info" style="display:none;" data-i18n="hint">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                    <button id="clearBtn" class="btn btn-secondary" data-i18n="clear">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    <button id="analyzeBtn" class="btn btn-warning" data-i18n="analyzeOff">üîç –ê–Ω–∞–ª–∏–∑ –í–´–ö–õ</button>
                    <button id="resignBtn" class="btn btn-danger" style="display:none;" data-i18n="resign">üè≥Ô∏è –°–¥–∞—Ç—å—Å—è</button>
                </div>

                <div class="game-info">
                    <div class="status-box">
                        <div id="gameStatus" data-i18n="createOrJoin">–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –∏–≥—Ä–µ</div>
                        <div id="gameLink" class="game-link hidden"></div>
                    </div>
                    
                    <div class="players">
                        <div class="player white">
                            <span class="player-icon">‚ôî</span>
                            <div class="player-info">
                                <span id="whitePlayer" data-i18n="white">–ë–µ–ª—ã–µ</span>
                                <div class="timer" id="whiteTimer">10:00</div>
                            </div>
                        </div>
                        <div class="player black">
                            <span class="player-icon">‚ôö</span>
                            <div class="player-info">
                                <span id="blackPlayer" data-i18n="black">–ß–µ—Ä–Ω—ã–µ</span>
                                <div class="timer" id="blackTimer">10:00</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ê–Ω–∞–ª–∏–∑ -->
            <div class="analysis-section">
                <div class="eval-bar-container">
                    <div class="eval-bar">
                        <div id="evalBarWhite" class="eval-bar-white"></div>
                        <div class="eval-score" id="evalScore">0.0</div>
                    </div>
                </div>

                <div class="analysis-info">
                    <h3 data-i18n="analysisTitle">üìä –ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–∏</h3>
                    <div id="analysisStatus" data-i18n="analysisOff">–í–∫–ª—é—á–∏—Ç–µ –∞–Ω–∞–ª–∏–∑</div>
                    <div id="moveQuality" class="move-quality"></div>
                </div>

                <div class="chat-section">
                    <h3 data-i18n="chat">üí¨ –ß–∞—Ç</h3>
                    <div id="chatMessages" class="chat-messages"></div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" data-i18n="messagePlaceholder" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button id="sendBtn" class="btn">üì§</button>
                    </div>
                </div>

                <div class="quick-chat">
                    <h3 data-i18n="quickChat">üí¨ –ë—ã—Å—Ç—Ä—ã–π —á–∞—Ç</h3>
                    <div class="quick-chat-buttons">
                        <button class="quick-chat-btn" data-msg-key="goodGame" data-i18n="goodGame">üëç –•–æ—Ä–æ—à–∞—è –∏–≥—Ä–∞</button>
                        <button class="quick-chat-btn" data-msg-key="thanks" data-i18n="thanks">üôè –°–ø–∞—Å–∏–±–æ</button>
                        <button class="quick-chat-btn" data-msg-key="goodLuck" data-i18n="goodLuck">üçÄ –£–¥–∞—á–∏</button>
                        <button class="quick-chat-btn" data-msg-key="niceMove" data-i18n="niceMove">‚≠ê –û—Ç–ª–∏—á–Ω—ã–π —Ö–æ–¥</button>
                        <button class="quick-chat-btn" data-msg-key="draw?" data-i18n="draw?">ü§ù –ù–∏—á—å—è?</button>
                        <button class="quick-chat-btn" data-msg-key="rematch?" data-i18n="rematch?">üîÑ –ï—â—ë –ø–∞—Ä—Ç–∏—é?</button>
                    </div>
                </div>

                <div class="moves-history">
                    <h3 data-i18n="movesHistory">–ò—Å—Ç–æ—Ä–∏—è –ø–∞—Ä—Ç–∏–∏</h3>
                    <div id="movesList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Local libraries for Android -->
    <script src="jquery.min.js"></script>
    <script src="chessboard.min.js"></script>
    <script src="chess.js"></script>
    <script src="peerjs.min.js"></script>
    <script src="stockfish.js"></script>
    
    <!-- Firebase (requires internet) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <script src="firebase-config.js"></script>
    <script src="i18n.js"></script>
    <script src="multiplayer.js"></script>
    <script src="puzzles.js"></script>
    <script src="supabase-multiplayer.js"></script>
</body>
</html>
